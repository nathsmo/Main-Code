[/bin/bash] #### Starting Python test
[/bin/bash] ## This is s3516423 on node876 and this job has the ID 2554104
[/bin/bash] ## current working directory: /home/s3516423/data1/Main-Code
[/bin/bash] ## Run script
actor_net_lr: 0.0001
batch_size: 128
beam_width: 10
critic_net_lr: 0.0001
data_dir: data
decode_len: 20
decoder: self
disable_tqdm: True
dropout: 0.1
emb_type: linear
embedding_dim: 128
entropy_coeff: 0.0
epsilon: 0.1
forget_bias: 1.0
gpu: 3
hidden_dim: 128
infer_type: batch
input_dim: 2
is_train: False
load_path: 
log_dir: logs/tsp20-2024-06-21_21-42-53
log_interval: 200
mask_glimpses: True
mask_pointer: True
max_grad_norm: 2.0
model_dir: ./logs/B2_lin/model/agent_complete.pth
n_glimpses: 0
n_nodes: 20
n_process_blocks: 3
n_train: 25000
num_heads: 1
random_seed: 24601
rnn_layers: 1
save_interval: 10000
stdout_print: True
tanh_exploration: 10.0
task: tsp20
task_name: tsp
test_interval: 200
test_size: 1000
use_tanh: False
variation: B2_lin
# Set random seed to 24601
# Set parameters for this run:
# Variation:    B2_lin
# Task:         tsp20
# Decoder:      self
# Embed type:   linear
# n_glimpses:   0
# rnn layers:   1
# n_train:      25000
# num heads:    1
Embedding - linear
Agent created - Self Attention.
Evaluation started ...
Average of greedy in batch-mode: -10.222003936767578 -- std R: 4.055056571960449 -- time 0.8623778820037842 s
##################################################################
Total time is 00:00:00
actor_net_lr: 0.0001
batch_size: 128
beam_width: 10
critic_net_lr: 0.0001
data_dir: data
decode_len: 20
decoder: self
disable_tqdm: True
dropout: 0.1
emb_type: enhanced
embedding_dim: 128
entropy_coeff: 0.0
epsilon: 0.1
forget_bias: 1.0
gpu: 3
hidden_dim: 128
infer_type: batch
input_dim: 2
is_train: False
load_path: 
log_dir: logs/tsp20-2024-06-21_21-42-57
log_interval: 200
mask_glimpses: True
mask_pointer: True
max_grad_norm: 2.0
model_dir: ./logs/B2_en/model/agent_complete.pth
n_glimpses: 0
n_nodes: 20
n_process_blocks: 3
n_train: 25000
num_heads: 1
random_seed: 24601
rnn_layers: 1
save_interval: 10000
stdout_print: True
tanh_exploration: 10.0
task: tsp20
task_name: tsp
test_interval: 200
test_size: 1000
use_tanh: False
variation: B2_en
# Set random seed to 24601
# Set parameters for this run:
# Variation:    B2_en
# Task:         tsp20
# Decoder:      self
# Embed type:   enhanced
# n_glimpses:   0
# rnn layers:   1
# n_train:      25000
# num heads:    1
Embedding - enhanced 2
Agent created - Self Attention.
Evaluation started ...
Traceback (most recent call last):
  File "/data1/s3516423/Main-Code/main.py", line 121, in <module>
    run_code = principal(args, prt)  # Create an instance
               ^^^^^^^^^^^^^^^^^^^^
  File "/data1/s3516423/Main-Code/main.py", line 69, in __init__
    self.agent.load_state_dict(torch.load(args['model_dir']))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s3516423/.local/lib/python3.11/site-packages/torch/serialization.py", line 997, in load
    with _open_file_like(f, 'rb') as opened_file:
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s3516423/.local/lib/python3.11/site-packages/torch/serialization.py", line 444, in _open_file_like
    return _open_file(name_or_buffer, mode)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s3516423/.local/lib/python3.11/site-packages/torch/serialization.py", line 425, in __init__
    super().__init__(open(name, mode))
                     ^^^^^^^^^^^^^^^^
IsADirectoryError: [Errno 21] Is a directory: './logs/B2_en/model/agent_complete.pth'
actor_net_lr: 0.0001
batch_size: 128
beam_width: 10
critic_net_lr: 0.0001
data_dir: data
decode_len: 20
decoder: self
disable_tqdm: True
dropout: 0.1
emb_type: enhanced2
embedding_dim: 128
entropy_coeff: 0.0
epsilon: 0.1
forget_bias: 1.0
gpu: 3
hidden_dim: 128
infer_type: batch
input_dim: 2
is_train: False
load_path: 
log_dir: logs/tsp20-2024-06-21_21-42-59
log_interval: 200
mask_glimpses: True
mask_pointer: True
max_grad_norm: 2.0
model_dir: ./logs/B2_en2/model/agent_complete.pth
n_glimpses: 0
n_nodes: 20
n_process_blocks: 3
n_train: 25000
num_heads: 1
random_seed: 24601
rnn_layers: 1
save_interval: 10000
stdout_print: True
tanh_exploration: 10.0
task: tsp20
task_name: tsp
test_interval: 200
test_size: 1000
use_tanh: False
variation: B2_en2
# Set random seed to 24601
# Set parameters for this run:
# Variation:    B2_en2
# Task:         tsp20
# Decoder:      self
# Embed type:   enhanced2
# n_glimpses:   0
# rnn layers:   1
# n_train:      25000
# num heads:    1
Embedding - enhanced og
Agent created - Self Attention.
Evaluation started ...
Average of greedy in batch-mode: -10.376875877380371 -- std R: 4.2336578369140625 -- time 0.8912169933319092 s
##################################################################
Total time is 00:00:00
actor_net_lr: 0.0001
batch_size: 128
beam_width: 10
critic_net_lr: 0.0001
data_dir: data
decode_len: 20
decoder: self
disable_tqdm: True
dropout: 0.1
emb_type: minimal
embedding_dim: 128
entropy_coeff: 0.0
epsilon: 0.1
forget_bias: 1.0
gpu: 3
hidden_dim: 128
infer_type: batch
input_dim: 2
is_train: False
load_path: 
log_dir: logs/tsp20-2024-06-21_21-43-03
log_interval: 200
mask_glimpses: True
mask_pointer: True
max_grad_norm: 2.0
model_dir: ./logs/B2_min/model/agent_complete.pth
n_glimpses: 0
n_nodes: 20
n_process_blocks: 3
n_train: 25000
num_heads: 1
random_seed: 24601
rnn_layers: 1
save_interval: 10000
stdout_print: True
tanh_exploration: 10.0
task: tsp20
task_name: tsp
test_interval: 200
test_size: 1000
use_tanh: False
variation: B2_min
# Set random seed to 24601
# Set parameters for this run:
# Variation:    B2_min
# Task:         tsp20
# Decoder:      self
# Embed type:   minimal
# n_glimpses:   0
# rnn layers:   1
# n_train:      25000
# num heads:    1
Embedding - Minimal
Agent created - Self Attention.
Evaluation started ...
Traceback (most recent call last):
  File "/data1/s3516423/Main-Code/main.py", line 121, in <module>
    run_code = principal(args, prt)  # Create an instance
               ^^^^^^^^^^^^^^^^^^^^
  File "/data1/s3516423/Main-Code/main.py", line 69, in __init__
    self.agent.load_state_dict(torch.load(args['model_dir']))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s3516423/.local/lib/python3.11/site-packages/torch/serialization.py", line 997, in load
    with _open_file_like(f, 'rb') as opened_file:
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s3516423/.local/lib/python3.11/site-packages/torch/serialization.py", line 444, in _open_file_like
    return _open_file(name_or_buffer, mode)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s3516423/.local/lib/python3.11/site-packages/torch/serialization.py", line 425, in __init__
    super().__init__(open(name, mode))
                     ^^^^^^^^^^^^^^^^
IsADirectoryError: [Errno 21] Is a directory: './logs/B2_min/model/agent_complete.pth'
actor_net_lr: 0.0001
batch_size: 128
beam_width: 10
critic_net_lr: 0.0001
data_dir: data
decode_len: 20
decoder: self
disable_tqdm: True
dropout: 0.1
emb_type: minimal
embedding_dim: 128
entropy_coeff: 0.0
epsilon: 0.1
forget_bias: 1.0
gpu: 3
hidden_dim: 128
infer_type: batch
input_dim: 2
is_train: False
load_path: 
log_dir: logs/tsp20-2024-06-21_21-43-06
log_interval: 200
mask_glimpses: True
mask_pointer: True
max_grad_norm: 2.0
model_dir: ./logs/B2_min_2/model/agent_complete.pth
n_glimpses: 0
n_nodes: 20
n_process_blocks: 3
n_train: 25000
num_heads: 1
random_seed: 24601
rnn_layers: 1
save_interval: 10000
stdout_print: True
tanh_exploration: 10.0
task: tsp20
task_name: tsp
test_interval: 200
test_size: 1000
use_tanh: False
variation: B2_min
# Set random seed to 24601
# Set parameters for this run:
# Variation:    B2_min
# Task:         tsp20
# Decoder:      self
# Embed type:   minimal
# n_glimpses:   0
# rnn layers:   1
# n_train:      25000
# num heads:    1
Embedding - Minimal
Agent created - Self Attention.
Evaluation started ...
Average of greedy in batch-mode: -10.222003936767578 -- std R: 4.055056571960449 -- time 0.7361772060394287 s
##################################################################
Total time is 00:00:00
actor_net_lr: 0.0001
batch_size: 128
beam_width: 10
critic_net_lr: 0.0001
data_dir: data
decode_len: 20
decoder: self
disable_tqdm: True
dropout: 0.1
emb_type: linear
embedding_dim: 128
entropy_coeff: 0.0
epsilon: 0.1
forget_bias: 1.0
gpu: 3
hidden_dim: 128
infer_type: batch
input_dim: 2
is_train: False
load_path: 
log_dir: logs/tsp20-2024-06-21_21-43-09
log_interval: 200
mask_glimpses: True
mask_pointer: True
max_grad_norm: 2.0
model_dir: ./logs/D2_lin/model/agent_complete.pth
n_glimpses: 0
n_nodes: 20
n_process_blocks: 3
n_train: 25000
num_heads: 4
random_seed: 24601
rnn_layers: 1
save_interval: 10000
stdout_print: True
tanh_exploration: 10.0
task: tsp20
task_name: tsp
test_interval: 200
test_size: 1000
use_tanh: False
variation: D2_lin
# Set random seed to 24601
# Set parameters for this run:
# Variation:    D2_lin
# Task:         tsp20
# Decoder:      self
# Embed type:   linear
# n_glimpses:   0
# rnn layers:   1
# n_train:      25000
# num heads:    4
Embedding - linear
Agent created - Self Attention.
Evaluation started ...
Average of greedy in batch-mode: -10.222003936767578 -- std R: 4.055056571960449 -- time 0.8880126476287842 s
##################################################################
Total time is 00:00:00
actor_net_lr: 0.0001
batch_size: 128
beam_width: 10
critic_net_lr: 0.0001
data_dir: data
decode_len: 20
decoder: pointer
disable_tqdm: True
dropout: 0.1
emb_type: linear
embedding_dim: 128
entropy_coeff: 0.0
epsilon: 0.1
forget_bias: 1.0
gpu: 3
hidden_dim: 128
infer_type: batch
input_dim: 2
is_train: False
load_path: 
log_dir: logs/tsp20-2024-06-21_21-43-12
log_interval: 200
mask_glimpses: True
mask_pointer: True
max_grad_norm: 2.0
model_dir: ./logs/E2_lin/model/agent_complete.pth
n_glimpses: 3
n_nodes: 20
n_process_blocks: 3
n_train: 25000
num_heads: 1
random_seed: 24601
rnn_layers: 1
save_interval: 10000
stdout_print: True
tanh_exploration: 10.0
task: tsp20
task_name: tsp
test_interval: 200
test_size: 1000
use_tanh: False
variation: E2_lin
# Set random seed to 24601
# Set parameters for this run:
# Variation:    E2_lin
# Task:         tsp20
# Decoder:      pointer
# Embed type:   linear
# n_glimpses:   3
# rnn layers:   1
# n_train:      25000
# num heads:    1
Embedding - linear
Agent created - Pointer Network.
Evaluation started ...
Average of greedy in batch-mode: -7.869347095489502 -- std R: 1.105147123336792 -- time 2.331864595413208 s
##################################################################
Total time is 00:00:02
actor_net_lr: 0.0001
batch_size: 128
beam_width: 10
critic_net_lr: 0.0001
data_dir: data
decode_len: 20
decoder: pointer
disable_tqdm: True
dropout: 0.1
emb_type: enhanced2
embedding_dim: 128
entropy_coeff: 0.0
epsilon: 0.1
forget_bias: 1.0
gpu: 3
hidden_dim: 128
infer_type: batch
input_dim: 2
is_train: False
load_path: 
log_dir: logs/tsp20-2024-06-21_21-43-18
log_interval: 200
mask_glimpses: True
mask_pointer: True
max_grad_norm: 2.0
model_dir: ./logs/E2_en2/model/agent_complete.pth
n_glimpses: 3
n_nodes: 20
n_process_blocks: 3
n_train: 25000
num_heads: 1
random_seed: 24601
rnn_layers: 1
save_interval: 10000
stdout_print: True
tanh_exploration: 10.0
task: tsp20
task_name: tsp
test_interval: 200
test_size: 1000
use_tanh: False
variation: E2_en2
# Set random seed to 24601
# Set parameters for this run:
# Variation:    E2_en2
# Task:         tsp20
# Decoder:      pointer
# Embed type:   enhanced2
# n_glimpses:   3
# rnn layers:   1
# n_train:      25000
# num heads:    1
Embedding - enhanced og
Agent created - Pointer Network.
Evaluation started ...
Average of greedy in batch-mode: -9.159574508666992 -- std R: 1.1331301927566528 -- time 2.3621103763580322 s
##################################################################
Total time is 00:00:02
[/bin/bash] ## Script finished
