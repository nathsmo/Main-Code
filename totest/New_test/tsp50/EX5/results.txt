# Set parameters for this run:
# Variation:    EX5
# Task:         tsp50
# Decoder:      pointer
# emb_type:     linear
# n_glimpses:   0
# rnn_layers:   1
# n_train:      10000
# num_heads:    1

actor_net_lr: 0.0001
batch_size: 128
beam_width: 10
critic_net_lr: 0.0001
data_dir: data
decode_len: 50
* decoder: pointer
disable_tqdm: True
dropout: 0.1
* emb_type: linear
embedding_dim: 128
entropy_coeff: 0.0
forget_bias: 1.0
gpu: 3
hidden_dim: 128
infer_type: batch
input_dim: 2
is_train: True
load_path: 
log_dir: logs/tsp50-2024-05-27_12-40-34
log_interval: 200
mask_glimpses: True
mask_pointer: True
max_grad_norm: 2.0
model_dir: logs/tsp50-2024-05-27_12-40-34/model
* n_glimpses: 0
n_nodes: 50
n_process_blocks: 3
* n_train: 10,000
num_heads: 1
random_seed: 24601
rnn_layers: 1
save_interval: 10000
stdout_print: True
tanh_exploration: 10.0
task: tsp50
task_name: tsp
test_interval: 200
test_size: 1000
use_tanh: False
# Set random seed to 24601
Training the agent...
Train Step: 0 -- Time: 00:00:02 -- Train reward: -22.967987060546875 -- Value: -0.16908353567123413
    actor loss: 3046.946044921875 -- critic loss: 523.5913696289062
Average of greedy in batch-mode: -17.516681671142578 -- std R: 1.7222776412963867 -- time 0.00016760826110839844 s
##################################################################
Train Step: 200 -- Time: 00:12:50 -- Train reward: -22.918867111206055 -- Value: -0.11020329594612122
    actor loss: 3042.51416015625 -- critic loss: 524.2698364257812
Average of greedy in batch-mode: -17.789670944213867 -- std R: 1.9152343273162842 -- time 0.00023651123046875 s
##################################################################
Train Step: 400 -- Time: 00:13:31 -- Train reward: -23.053665161132812 -- Value: -0.03280673548579216
    actor loss: 3079.139404296875 -- critic loss: 533.5098876953125
Average of greedy in batch-mode: -17.452178955078125 -- std R: 2.2986414432525635 -- time 0.00019669532775878906 s
##################################################################
Train Step: 600 -- Time: 00:13:48 -- Train reward: -23.268362045288086 -- Value: -0.007266540080308914
    actor loss: 3129.73974609375 -- critic loss: 544.61376953125
Average of greedy in batch-mode: -17.632606506347656 -- std R: 2.196268320083618 -- time 0.0001709461212158203 s
##################################################################
Train Step: 800 -- Time: 00:13:53 -- Train reward: -23.10158348083496 -- Value: -0.2209399938583374
    actor loss: 3067.332275390625 -- critic loss: 527.5679321289062
Average of greedy in batch-mode: -17.726009368896484 -- std R: 2.0724258422851562 -- time 0.0002002716064453125 s
##################################################################
Train Step: 1000 -- Time: 00:13:39 -- Train reward: -22.888694763183594 -- Value: -0.06084060296416283
    actor loss: 3056.883056640625 -- critic loss: 525.9266967773438
Average of greedy in batch-mode: -17.479747772216797 -- std R: 1.9167131185531616 -- time 0.00018143653869628906 s
##################################################################
Train Step: 1200 -- Time: 00:13:27 -- Train reward: -22.82358169555664 -- Value: 0.11115948110818863
    actor loss: 3076.6689453125 -- critic loss: 530.7252807617188
Average of greedy in batch-mode: -17.6462459564209 -- std R: 1.8967748880386353 -- time 0.00016069412231445312 s
##################################################################
Train Step: 1400 -- Time: 00:13:29 -- Train reward: -22.923025131225586 -- Value: -0.10331028699874878
    actor loss: 3062.097900390625 -- critic loss: 524.6666259765625
Average of greedy in batch-mode: -17.60721206665039 -- std R: 2.0428261756896973 -- time 0.00022459030151367188 s
##################################################################
Train Step: 1600 -- Time: 00:13:21 -- Train reward: -22.745868682861328 -- Value: -0.045841723680496216
    actor loss: 3034.7568359375 -- critic loss: 518.7133178710938
Average of greedy in batch-mode: -17.86072540283203 -- std R: 2.0042078495025635 -- time 0.00015091896057128906 s
##################################################################
Train Step: 1800 -- Time: 00:13:16 -- Train reward: -23.20160484313965 -- Value: 0.17761501669883728
    actor loss: 3119.33203125 -- critic loss: 550.4557495117188
Average of greedy in batch-mode: -17.96258544921875 -- std R: 1.89354407787323 -- time 0.00018310546875 s
##################################################################
Train Step: 2000 -- Time: 00:13:23 -- Train reward: -22.891618728637695 -- Value: -0.09576642513275146
    actor loss: 3047.38232421875 -- critic loss: 523.02490234375
Average of greedy in batch-mode: -17.50664520263672 -- std R: 2.0192949771881104 -- time 0.00014257431030273438 s
##################################################################
Train Step: 2200 -- Time: 00:13:38 -- Train reward: -22.962478637695312 -- Value: -0.05659399926662445
    actor loss: 3052.830322265625 -- critic loss: 528.4830932617188
Average of greedy in batch-mode: -17.910655975341797 -- std R: 2.1105077266693115 -- time 0.0001475811004638672 s
##################################################################
Train Step: 2400 -- Time: 00:13:31 -- Train reward: -23.01667022705078 -- Value: -0.051641546189785004
    actor loss: 3075.8349609375 -- critic loss: 530.1717529296875
Average of greedy in batch-mode: -17.72004508972168 -- std R: 2.211315393447876 -- time 0.00017499923706054688 s
##################################################################
Train Step: 2600 -- Time: 00:13:20 -- Train reward: -22.818531036376953 -- Value: 0.0568467378616333
    actor loss: 3067.400634765625 -- critic loss: 526.9386596679688
Average of greedy in batch-mode: -17.605226516723633 -- std R: 1.8119957447052002 -- time 0.0001347064971923828 s
##################################################################
Train Step: 2800 -- Time: 00:13:14 -- Train reward: -22.876178741455078 -- Value: 0.15361085534095764
    actor loss: 3082.18505859375 -- critic loss: 533.617431640625
Average of greedy in batch-mode: -18.08829116821289 -- std R: 2.2176105976104736 -- time 0.00013875961303710938 s
##################################################################
Train Step: 3000 -- Time: 00:13:18 -- Train reward: -22.876773834228516 -- Value: -0.027252286672592163
    actor loss: 3053.7041015625 -- critic loss: 525.7908935546875
Average of greedy in batch-mode: -18.007658004760742 -- std R: 2.058897018432617 -- time 0.00036716461181640625 s
##################################################################
Train Step: 3200 -- Time: 00:13:23 -- Train reward: -22.977642059326172 -- Value: 0.05465644225478172
    actor loss: 3090.47412109375 -- critic loss: 533.8823852539062
Average of greedy in batch-mode: -17.65371322631836 -- std R: 2.0028250217437744 -- time 0.00015211105346679688 s
##################################################################
Train Step: 3400 -- Time: 00:13:27 -- Train reward: -23.219558715820312 -- Value: -0.1565152108669281
    actor loss: 3075.36474609375 -- critic loss: 535.634765625
Average of greedy in batch-mode: -17.4389591217041 -- std R: 1.7682586908340454 -- time 0.00015211105346679688 s
##################################################################
Train Step: 3600 -- Time: 00:13:30 -- Train reward: -23.15491485595703 -- Value: -0.026058893650770187
    actor loss: 3107.582763671875 -- critic loss: 538.46923828125
Average of greedy in batch-mode: -17.838653564453125 -- std R: 2.2295749187469482 -- time 0.00015211105346679688 s
##################################################################
Train Step: 3800 -- Time: 00:14:08 -- Train reward: -22.724790573120117 -- Value: -0.08731590956449509
    actor loss: 3017.315185546875 -- critic loss: 515.6466064453125
Average of greedy in batch-mode: -18.061687469482422 -- std R: 2.0064213275909424 -- time 0.00017690658569335938 s
##################################################################
Train Step: 4000 -- Time: 00:14:13 -- Train reward: -22.520109176635742 -- Value: -0.04725959524512291
    actor loss: 2994.12255859375 -- critic loss: 507.9236755371094
Average of greedy in batch-mode: -17.922042846679688 -- std R: 2.0189435482025146 -- time 0.00016260147094726562 s
##################################################################
Train Step: 4200 -- Time: 00:13:44 -- Train reward: -22.980093002319336 -- Value: -0.06550128757953644
    actor loss: 3055.001953125 -- critic loss: 528.0305786132812
Average of greedy in batch-mode: -17.769744873046875 -- std R: 2.0764143466949463 -- time 0.00013327598571777344 s
##################################################################
Train Step: 4400 -- Time: 00:13:39 -- Train reward: -22.943496704101562 -- Value: -0.06922906637191772
    actor loss: 3066.822265625 -- critic loss: 527.4481811523438
Average of greedy in batch-mode: -17.546804428100586 -- std R: 1.719157099723816 -- time 0.00017786026000976562 s
##################################################################
Train Step: 4600 -- Time: 00:13:41 -- Train reward: -23.0733699798584 -- Value: -0.06165609881281853
    actor loss: 3089.42041015625 -- critic loss: 532.2455444335938
Average of greedy in batch-mode: -17.980297088623047 -- std R: 1.8648924827575684 -- time 0.00014519691467285156 s
##################################################################
Train Step: 4800 -- Time: 00:13:43 -- Train reward: -22.734806060791016 -- Value: -0.11328823864459991
    actor loss: 3017.235595703125 -- critic loss: 514.9907836914062
Average of greedy in batch-mode: -17.520761489868164 -- std R: 1.9950547218322754 -- time 0.00014162063598632812 s
##################################################################
Train Step: 5000 -- Time: 00:13:43 -- Train reward: -23.010419845581055 -- Value: -0.026342332363128662
    actor loss: 3073.328857421875 -- critic loss: 532.305419921875
Average of greedy in batch-mode: -17.658447265625 -- std R: 2.153876781463623 -- time 0.00017118453979492188 s
##################################################################
Train Step: 5200 -- Time: 00:13:53 -- Train reward: -23.38081932067871 -- Value: 0.03624911606311798
    actor loss: 3143.7314453125 -- critic loss: 551.546875
Average of greedy in batch-mode: -17.21622657775879 -- std R: 1.9393258094787598 -- time 0.00013589859008789062 s
##################################################################
Train Step: 5400 -- Time: 00:13:59 -- Train reward: -22.886272430419922 -- Value: -0.014411622658371925
    actor loss: 3068.40673828125 -- critic loss: 526.50439453125
Average of greedy in batch-mode: -17.528676986694336 -- std R: 2.1083078384399414 -- time 0.00017690658569335938 s
##################################################################
Train Step: 5600 -- Time: 00:13:54 -- Train reward: -23.040786743164062 -- Value: 0.12459872663021088
    actor loss: 3089.7099609375 -- critic loss: 539.4725341796875
Average of greedy in batch-mode: -17.59998893737793 -- std R: 1.9583892822265625 -- time 0.00014829635620117188 s
##################################################################
Train Step: 5800 -- Time: 00:13:55 -- Train reward: -23.245174407958984 -- Value: -0.07295829057693481
    actor loss: 3103.519287109375 -- critic loss: 540.8521118164062
Average of greedy in batch-mode: -17.62674903869629 -- std R: 2.133368492126465 -- time 0.00016760826110839844 s
##################################################################
Train Step: 6000 -- Time: 00:14:02 -- Train reward: -23.193376541137695 -- Value: -0.05719311907887459
    actor loss: 3117.48291015625 -- critic loss: 539.6898803710938
Average of greedy in batch-mode: -17.5159854888916 -- std R: 2.02382755279541 -- time 0.00016427040100097656 s
##################################################################
Train Step: 6200 -- Time: 00:14:02 -- Train reward: -22.917638778686523 -- Value: 0.060097694396972656
    actor loss: 3077.37841796875 -- critic loss: 530.981689453125
Average of greedy in batch-mode: -17.700666427612305 -- std R: 2.0931358337402344 -- time 0.00017142295837402344 s
##################################################################
Train Step: 6400 -- Time: 00:14:01 -- Train reward: -23.566282272338867 -- Value: 0.0986088365316391
    actor loss: 3183.6162109375 -- critic loss: 563.547607421875
Average of greedy in batch-mode: -17.624961853027344 -- std R: 1.8676235675811768 -- time 0.0001678466796875 s
##################################################################
Train Step: 6600 -- Time: 00:14:02 -- Train reward: -23.373531341552734 -- Value: -0.2182818502187729
    actor loss: 3100.169677734375 -- critic loss: 540.5125732421875
Average of greedy in batch-mode: -17.727054595947266 -- std R: 1.9084104299545288 -- time 0.00015211105346679688 s
##################################################################
Train Step: 6800 -- Time: 00:13:58 -- Train reward: -23.19568634033203 -- Value: 0.1291399896144867
    actor loss: 3123.60791015625 -- critic loss: 548.63330078125
Average of greedy in batch-mode: -18.18273162841797 -- std R: 1.9777114391326904 -- time 0.0001678466796875 s
##################################################################
Train Step: 7000 -- Time: 00:13:44 -- Train reward: -23.042150497436523 -- Value: -0.09972309321165085
    actor loss: 3065.021728515625 -- critic loss: 530.3511352539062
Average of greedy in batch-mode: -17.773963928222656 -- std R: 1.9615825414657593 -- time 0.0001621246337890625 s
##################################################################
Train Step: 7200 -- Time: 00:13:11 -- Train reward: -23.037382125854492 -- Value: -0.025414232164621353
    actor loss: 3080.0927734375 -- critic loss: 532.9699096679688
Average of greedy in batch-mode: -17.404155731201172 -- std R: 2.0519814491271973 -- time 0.00016379356384277344 s
##################################################################
Train Step: 7400 -- Time: 00:13:18 -- Train reward: -22.980039596557617 -- Value: -0.09814644604921341
    actor loss: 3055.97509765625 -- critic loss: 526.9271850585938
Average of greedy in batch-mode: -17.8272647857666 -- std R: 2.1648685932159424 -- time 0.0001461505889892578 s
##################################################################
Train Step: 7600 -- Time: 00:13:14 -- Train reward: -22.74542808532715 -- Value: 0.02378695458173752
    actor loss: 3036.115966796875 -- critic loss: 522.2200927734375
Average of greedy in batch-mode: -17.833993911743164 -- std R: 1.8752802610397339 -- time 0.00015497207641601562 s
##################################################################
Train Step: 7800 -- Time: 00:13:18 -- Train reward: -23.06587028503418 -- Value: 0.03798453509807587
    actor loss: 3098.651123046875 -- critic loss: 537.9957275390625
Average of greedy in batch-mode: -17.552427291870117 -- std R: 1.8974053859710693 -- time 0.0001456737518310547 s
##################################################################
Train Step: 8000 -- Time: 00:13:19 -- Train reward: -23.130434036254883 -- Value: 0.08233275264501572
    actor loss: 3119.2509765625 -- critic loss: 543.062255859375
Average of greedy in batch-mode: -17.75287628173828 -- std R: 2.2007548809051514 -- time 0.00020265579223632812 s
##################################################################
Train Step: 8200 -- Time: 00:12:57 -- Train reward: -23.29073143005371 -- Value: 0.015759002417325974
    actor loss: 3134.054443359375 -- critic loss: 546.671630859375
Average of greedy in batch-mode: -17.71317481994629 -- std R: 2.0958445072174072 -- time 0.00014162063598632812 s
##################################################################
Train Step: 8400 -- Time: 00:12:25 -- Train reward: -22.832921981811523 -- Value: -0.00844956561923027
    actor loss: 3064.10205078125 -- critic loss: 524.2274780273438
Average of greedy in batch-mode: -17.603620529174805 -- std R: 2.0361859798431396 -- time 0.0001556873321533203 s
##################################################################
Train Step: 8600 -- Time: 00:12:20 -- Train reward: -22.80726432800293 -- Value: -0.05362645536661148
    actor loss: 3032.94091796875 -- critic loss: 521.177734375
Average of greedy in batch-mode: -17.698402404785156 -- std R: 1.733952522277832 -- time 0.00013637542724609375 s
##################################################################
Train Step: 8800 -- Time: 00:12:29 -- Train reward: -23.132965087890625 -- Value: 0.06861838698387146
    actor loss: 3103.319091796875 -- critic loss: 541.4625244140625
Average of greedy in batch-mode: -17.87982940673828 -- std R: 1.947890281677246 -- time 0.0001373291015625 s
##################################################################
Train Step: 9000 -- Time: 00:12:37 -- Train reward: -22.946125030517578 -- Value: -0.08555141091346741
    actor loss: 3068.9814453125 -- critic loss: 526.7281494140625
Average of greedy in batch-mode: -17.87652587890625 -- std R: 2.04223370552063 -- time 0.00013566017150878906 s
##################################################################
Train Step: 9200 -- Time: 00:12:31 -- Train reward: -23.12995147705078 -- Value: -0.05785863846540451
    actor loss: 3093.4453125 -- critic loss: 535.442138671875
Average of greedy in batch-mode: -17.748220443725586 -- std R: 1.8997156620025635 -- time 0.00014638900756835938 s
##################################################################
Train Step: 9400 -- Time: 00:12:31 -- Train reward: -23.356590270996094 -- Value: -0.009981967508792877
    actor loss: 3124.01708984375 -- critic loss: 548.437744140625
Average of greedy in batch-mode: -17.996944427490234 -- std R: 2.1998093128204346 -- time 0.00014829635620117188 s
##################################################################
Train Step: 9600 -- Time: 00:12:20 -- Train reward: -22.922441482543945 -- Value: -0.014337500557303429
    actor loss: 3062.12060546875 -- critic loss: 527.5567626953125
Average of greedy in batch-mode: -17.876102447509766 -- std R: 1.9602775573730469 -- time 0.00015354156494140625 s
##################################################################
Train Step: 9800 -- Time: 00:12:28 -- Train reward: -22.93341064453125 -- Value: 0.12486845999956131
    actor loss: 3091.5302734375 -- critic loss: 534.6834716796875
Average of greedy in batch-mode: -17.584331512451172 -- std R: 1.9536298513412476 -- time 0.0001442432403564453 s
##################################################################
Total time is 11:10:10
